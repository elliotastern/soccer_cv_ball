# Resume Training Configuration - Multi-scale Enabled
# Enables multi-scale training to improve small object (ball) detection
# WARNING: May increase memory usage - monitor GPU memory

model:
  architecture: detr
  backbone: resnet50
  num_classes: 2
  pretrained: true
  hidden_dim: 256
  nheads: 8
  num_encoder_layers: 6
  num_decoder_layers: 6
  rfdetr_size: base
  remap_mscoco_category: false

training:
  batch_size: 2  # Keep at 2 (already minimum)
  learning_rate: 0.0001  # Reduced LR for fine-tuning phase
  epochs: 70  # Extended to 70 epochs (Phase 3)
  weight_decay: 0.0001
  gradient_clip: 0.1
  grad_accum_steps: 16  # Effective batch size (2*16=32)
  resolution: 1288  # Keep high resolution from Phase 1.5
  num_workers: 1
  device: cuda
  mixed_precision: true
  # Enable multi-scale training for small object detection
  multi_scale: true  # ENABLED - helps with small objects
  expanded_scales: false  # Keep disabled to save memory
  
dataset:
  coco_train_path: /workspace/soccer_cv_ball/models/ball_detection_combined_optimized/dataset/train
  coco_val_path: /workspace/soccer_cv_ball/models/ball_detection_combined_optimized/dataset/valid
  category_name: "ball"
  category_id: 0
  ball_class_id: 1
  pin_memory: false
  prefetch_factor: 1
  persistent_workers: false

checkpoint:
  resume_from: /workspace/soccer_cv_ball/models/checkpoint.pth
  start_epoch: 60  # Resuming from epoch 59 checkpoint (Phase 1.5 complete)
  save_dir: models/checkpoints

# Phase 3: Multi-Scale Training (Epochs 60-70)
# Resuming from Phase 1.5 completion (Epoch 59)
# Current performance: 0.679 mAP, 0.653 small objects mAP
#
# Changes from Phase 1.5:
# - multi_scale: true (ENABLED for scale invariance)
# - learning_rate: 0.0001 (reduced for fine-tuning)
# - epochs: 70 (train 10 more epochs)
#
# Benefits:
# - Multi-scale training helps model learn at multiple scales
# - Particularly beneficial for small object (ball) detection
# - Expected improvement: 0.653 -> 0.67+ small objects mAP
#
# Risks:
# - May increase GPU memory usage
# - Monitor memory and reduce batch_size if needed
